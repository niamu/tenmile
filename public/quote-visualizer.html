<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>format preview</title>
    <script src="lib/jszip-3.6.0.min.js"></script>
    <script src="lib/pako-2.0.3.min.js"></script>
    <script src="lib/UPNG-2.2.0.js"></script>
    <script src="lib/msgpack-1.0.3.js"></script>
    <script src="js/quotes.js"></script>
    <style>
      img {
        border: 1px solid green;
      }
    </style>
  </head>
  <body>
    Hello world
    <div id="images"></div>
  </body>
  <script defer>
    "use strict";

    window.gtag = function() {};

    let quoteUrl = "https://tenmile.s3.amazonaws.com/ZELDA-ed42-67fdbb51.png";

    async function urlToQuote(url) {
      let file = await fetch(url);
      let buffer = await file.arrayBuffer();
      let quote = await loadQuote(buffer);
      return quote;
    }

    let quote = null;
    let dta = null;
    let png = null;

    window.onload = async function runAllTests() {
      quote = await urlToQuote(quoteUrl);
      console.log("Ready");

      let h = 64;
      let w = 256;
      let blackPixel = [0, 0, 0, 255];
      let whitePixel = [255, 255, 255, 255];
      /*
      let custom = [];
      for (let x = 0; x < w * h; x++) {
        let pixel = blackPixel;
        custom.push(...pixel);
      }
      */
      /*
      let maskView = [];
      quote.masks.ROM.forEach(x => {
        let pixel = whitePixel;
        if (x > 0) {
          pixel = blackPixel;
        }
        maskView.push(...pixel);
      });
      /* */
      let falseColor = [];
      for(let x = 0; x < h; x++) {
        for(let y = 0; y < w; w++) {
          
        }
      }
      
      dta = maskView;
      png = UPNG.encode([dta], w, h);
      let blob = new Blob([png], { type: "image/png" });

      let img = document.createElement("img");
      img.src = URL.createObjectURL(blob);

      document.getElementById("images").appendChild(img);

      // images.appendChild(img);
    };
  </script>
</html>
