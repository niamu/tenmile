<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>automated tests</title>
    <script src="lib/pako.min.js" defer></script>
    <script src="lib/emitter.js"></script>
    <script src="lib/gameboy.js"></script>
    <script src="lib/UPNG.js"></script>
    <script src="lib/jszip.min.js"></script>
    <script src="lib/msgpack.js"></script>
    <script src="js/quotes.js"></script>
  </head>
  <body></body>
  <script>
      "use strict";

      const TEST_GAME_URL = "https://bonsaiden.github.io/Tuff.gb/roms/game.gb";

      const TESTS = {
        gbSaveRestore: async function() {
          let response = await fetch(TEST_GAME_URL);
          let rom = await response.arrayBuffer();
          
          let canvas = document.createElement("canvas");
          canvas.setAttribute("width", 160);
          canvas.setAttribute("height", 144);
          
          let opts = {};
          window.debug = ()=>{};
          let gameboy = GameBoyCore(canvas, rom, opts);
          
          for(let i = 0; i < 100; i++) {
            gameboy.run();
          }
          
          gameboy.
          
          return gameboy;
          
          /*
          Gb test: (save/restore determinism)
    - load rom
    - construct
    - run
    - joypadevent
    - run
    - save A
    - check A
    - run
    - joypadevent
    - run
    - save B
    - check B
    - restore
    - check A
    - run
    - joypadevent
    - run
    - save B
    - check B
          */

        }
    };

    (async function runAllTests() {
      for(let [name, test] of Object.entries(TESTS)) {
        console.log(`Running ${name}...`);
        try {
          let result = await test();
          console.log('Result:', result);
        } catch(exception) {
          console.warn(exception)
        }
      }
    })();
  </script>
</html>
